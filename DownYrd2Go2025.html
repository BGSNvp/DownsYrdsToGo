<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Football Down Tracker</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f4f8; /* Light gray background */
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            box-sizing: border-box;
        }
        .container {
            background-color: #ffffff; /* White background for the app */
            border-radius: 20px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            padding: 20px; /* Reduced padding from 30px */
            width: 100%;
            max-width: 400px;
            text-align: center;
            overflow: hidden; /* Ensure content fits */
        }
        /* New container for side-by-side display cards */
        .display-cards-wrapper {
            display: flex;
            justify-content: space-around; /* Distribute space evenly */
            gap: 10px; /* Reduced gap from 15px */
            margin-bottom: 15px; /* Reduced margin from 20px */
        }
        .display-card {
            background-color: #e2e8f0; /* Lighter gray for display areas */
            border-radius: 15px;
            padding: 8px 6px; /* Further reduced padding for smaller text */
            flex: 1; /* Allow cards to grow and shrink */
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-width: 90px; /* Adjusted min-width for smaller content */
        }
        .display-card h2 {
            font-size: 0.6rem; /* Significantly smaller text for label */
            font-weight: 600; /* font-semibold */
            color: #4a5568; /* gray-700 */
            margin-bottom: 3px; /* Reduced margin */
        }
        .display-card p {
            font-size: 1rem; /* Significantly smaller text for value */
            font-weight: 700; /* font-bold */
            color: #2d3748; /* gray-800 */
        }
        .control-group {
            margin-bottom: 15px; /* Reduced margin from 20px */
        }
        .control-group label {
            display: block;
            font-size: 0.9rem; /* Slightly smaller label for control groups */
            font-weight: 600;
            color: #4a5568;
            margin-bottom: 6px; /* Reduced margin */
        }
        .btn-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(50px, 1fr)); /* Adjusted minmax for slightly smaller buttons */
            gap: 8px; /* Reduced gap from 10px */
            margin-top: 8px; /* Reduced margin */
        }
        .btn {
            background-color: #4299e1; /* blue-500 */
            color: white;
            font-weight: 600; /* font-semibold */
            padding: 10px 12px; /* Reduced padding */
            border-radius: 10px;
            transition: background-color 0.2s, transform 0.1s;
            cursor: pointer;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            border: none;
            outline: none;
            text-align: center;
            white-space: nowrap; /* Prevent text wrapping */
            font-size: 0.9rem; /* Slightly smaller button text */
        }
        .btn:hover {
            background-color: #3182ce; /* blue-600 */
            transform: translateY(-1px);
        }
        .btn:active {
            background-color: #2b6cb0; /* blue-700 */
            transform: translateY(0);
            box-shadow: none;
        }
        .btn-primary-action { /* For Generate Link, Copy, Send to Sheet */
            width: 100%; /* Make these buttons full width */
            margin-top: 12px; /* Reduced margin from 15px */
        }
        .url-output {
            background-color: #f7fafc; /* gray-100 */
            border: 1px solid #cbd5e0; /* gray-300 */
            border-radius: 10px;
            padding: 12px; /* Reduced padding */
            word-break: break-all;
            text-align: left;
            min-height: 40px; /* Reduced min-height */
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem; /* Slightly smaller font */
            color: #2d3748;
            margin-top: 15px; /* Reduced margin */
            overflow-wrap: break-word;
        }
        .message-box {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: #2d3748; /* Dark background */
            color: white;
            padding: 15px 25px; /* Reduced padding */
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            z-index: 1000;
            display: none; /* Hidden by default */
            animation: fadeIn 0.3s ease-out;
            min-width: 220px; /* Reduced min-width */
            text-align: center;
            font-size: 0.9rem; /* Slightly smaller font */
        }
        .message-box.show {
            display: block;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translate(-50%, -60%); }
            to { opacity: 1; transform: translate(-50%, -50%); }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Removed the H1 title element -->

        <!-- Display Cards Wrapper for side-by-side layout -->
        <div class="display-cards-wrapper">
            <!-- Down Display -->
            <div class="display-card">
                <h2>Down</h2>
                <p id="downDisplay">1st</p>
            </div>

            <!-- Yards to Go Display -->
            <div class="display-card">
                <h2>Yards to Go</h2>
                <p id="yardsToGoDisplay">10</p>
            </div>
        </div>

        <!-- Down Buttons -->
        <div class="control-group">
            <label>Set Down:</label>
            <div class="btn-grid" id="downButtons">
                <button class="btn" data-down="1">1st</button>
                <button class="btn" data-down="2">2nd</button>
                <button class="btn" data-down="3">3rd</button>
                <button class="btn" data-down="4">4th</button>
            </div>
        </div>

        <!-- Yards to Go Buttons -->
        <div class="control-group">
            <label>Set Yards to Go:</label>
            <div class="btn-grid" id="yardsButtons">
                <button class="btn" data-yards="1">1</button>
                <button class="btn" data-yards="2">2</button>
                <button class="btn" data-yards="3">3</button>
                <button class="btn" data-yards="4">4</button>
                <button class="btn" data-yards="5">5</button>
                <button class="btn" data-yards="6">6</button>
                <button class="btn" data-yards="7">7</button>
                <button class="btn" data-yards="8">8</button>
                <button class="btn" data-yards="9">9</button>
                <button class="btn" data-yards="10">10</button>
                <button class="btn" data-yards="11">11</button>
                <button class="btn" data-yards="12">12</button>
                <button class="btn" data-yards="13">13</button>
                <button class="btn" data-yards="14">14</button>
                <button class="btn" data-yards="15">15</button>
                <button class="btn" data-yards="16">16</button>
                <button class="btn" data-yards="17">17</button>
                <button class="btn" data-yards="18">18</button>
                <button class="btn" data-yards="19">19</button>
                <button class="btn" data-yards="20">20</button>
                <button class="btn bg-gray-500 hover:bg-gray-600" data-yards="20+">20+</button>
                <button class="btn bg-red-500 hover:bg-red-600" data-yards="0">Goal</button>
            </div>
        </div>

        <!-- Button to send data to Google Sheet (moved up) -->
        <button id="sendToSheetBtn" class="btn btn-primary-action bg-green-600 hover:bg-green-700">Send to Google Sheet</button>

        <!-- URL Generation -->
        <button id="generateUrlBtn" class="btn btn-primary-action">Generate Link</button>
        <div id="urlOutput" class="url-output">
            Your generated URL will appear here.
        </div>
        <button id="copyUrlBtn" class="btn btn-primary-action bg-purple-500 hover:bg-purple-600">Copy URL</button>
    </div>

    <!-- Message Box for Alerts -->
    <div id="messageBox" class="message-box">
        <p id="messageText"></p>
    </div>

    <script>
        // DOM Elements
        const downDisplay = document.getElementById('downDisplay');
        const yardsToGoDisplay = document.getElementById('yardsToGoDisplay');
        const downButtonsContainer = document.getElementById('downButtons');
        const yardsButtonsContainer = document.getElementById('yardsButtons');
        const generateUrlBtn = document.getElementById('generateUrlBtn');
        const urlOutput = document.getElementById('urlOutput');
        const copyUrlBtn = document.getElementById('copyUrlBtn');
        const sendToSheetBtn = document.getElementById('sendToSheetBtn');
        const messageBox = document.getElementById('messageBox');
        const messageText = document.getElementById('messageText');

        // IMPORTANT: Replace this with the Web App URL you copied from Google Apps Script deployment
        const GOOGLE_APPS_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbw9KRK1Ycc0C-OIhPz5fYP9uoON3I0_tu5PxD654AxjMSS5WlD0AaopGIWeXriwar15_Q/exec'; // <<<--- REPLACE THIS LINE!

        // Initial state
        let currentDown = 1; // Stored as number for logic
        let yardsToGo = 10; // Stored as number for logic

        // Function to update the down display based on button click
        function updateDownDisplay(downValue) {
            currentDown = parseInt(downValue); // Ensure it's a number
            let downText;
            switch (currentDown) {
                case 1: downText = '1st'; break;
                case 2: downText = '2nd'; break;
                case 3: downText = '3rd'; break;
                case 4: downText = '4th'; break;
                default: downText = '1st'; // Fallback
            }
            downDisplay.textContent = downText;
        }

        // Function to update the yards to go display based on button click
        function updateYardsToGoDisplay(yardsValue) {
            if (yardsValue === '0') {
                yardsToGo = 0;
                yardsToGoDisplay.textContent = 'Goal';
            } else if (yardsValue === '20+') {
                yardsToGo = '20+'; // Store as string for this specific case
                yardsToGoDisplay.textContent = '20+';
            } else {
                yardsToGo = parseInt(yardsValue); // Ensure it's a number
                yardsToGoDisplay.textContent = yardsToGo;
            }
        }

        // Function to show a message box
        function showMessageBox(message, duration = 2000) {
            messageText.textContent = message;
            messageBox.classList.add('show');
            setTimeout(() => {
                messageBox.classList.remove('show');
            }, duration);
        }

        // Event Listeners for Down Buttons
        downButtonsContainer.addEventListener('click', (event) => {
            if (event.target.tagName === 'BUTTON') {
                const selectedDown = event.target.dataset.down;
                updateDownDisplay(selectedDown);
            }
        });

        // Event Listeners for Yards Buttons
        yardsButtonsContainer.addEventListener('click', (event) => {
            if (event.target.tagName === 'BUTTON') {
                const selectedYards = event.target.dataset.yards;
                updateYardsToGoDisplay(selectedYards);
            }
        });

        // Generate URL Button
        generateUrlBtn.addEventListener('click', () => {
            // Use the currently displayed text for URL generation
            const downString = encodeURIComponent(downDisplay.textContent);
            const yardsString = encodeURIComponent(yardsToGoDisplay.textContent);
            const baseUrl = 'https://your-domain.com/track?'; // Replace with your actual base URL if hosting
            const generatedUrl = `${baseUrl}down=${downString}&yards=${yardsString}`;
            urlOutput.textContent = generatedUrl;
            showMessageBox("URL Generated!");
        });

        // Copy URL Button
        copyUrlBtn.addEventListener('click', () => {
            const urlText = urlOutput.textContent;
            if (urlText && urlText !== "Your generated URL will appear here.") {
                const textArea = document.createElement("textarea");
                textArea.value = urlText;
                document.body.appendChild(textArea);
                textArea.select();
                try {
                    const successful = document.execCommand('copy');
                    if (successful) {
                        showMessageBox("URL Copied to Clipboard!");
                    } else {
                        showMessageBox("Failed to copy URL.");
                    }
                } catch (err) {
                    showMessageBox("Failed to copy URL.");
                    console.error('Copy command failed: ', err);
                }
                document.body.removeChild(textArea);
            } else {
                showMessageBox("No URL to copy yet!");
            }
        });

        // Send to Google Sheet Button
        sendToSheetBtn.addEventListener('click', async () => {
            if (GOOGLE_APPS_SCRIPT_URL === 'YOUR_DEPLOYED_GOOGLE_APPS_SCRIPT_URL_HERE') {
                showMessageBox("Please configure GOOGLE_APPS_SCRIPT_URL in the code first!");
                return;
            }

            // Use the currently displayed text for sending to sheet
            const downValue = downDisplay.textContent;
            const yardsValue = yardsToGoDisplay.textContent;

            const urlToSend = `${GOOGLE_APPS_SCRIPT_URL}?down=${encodeURIComponent(downValue)}&yards=${encodeURIComponent(yardsValue)}`;

            try {
                showMessageBox("Sending data to Google Sheet...", 3000);
                const response = await fetch(urlToSend);
                const resultText = await response.text();

                if (response.ok) {
                    showMessageBox(`Sheet updated: ${resultText}`);
                } else {
                    showMessageBox(`Sheet update failed: ${resultText}`);
                    console.error('Apps Script Error Response:', resultText);
                }
            } catch (error) {
                showMessageBox("Failed to send data to Google Sheet. Check console for details.");
                console.error('Error sending data to Apps Script:', error);
            }
        });

        // Initial setup
        updateDownDisplay(currentDown); // Set initial display for down
        updateYardsToGoDisplay(yardsToGo); // Set initial display for yards
    </script>
</body>
</html>